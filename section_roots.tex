%!TEX root = main.tex
\section{On Roots of Unity} \label{section:roots}
Whether NTT or FFT, all fourier transform related algorithms require certain roots of unity. Suppose we need to compute the fourier transform of \(N\) data points, we generally need \(N\) distinct roots of unity, but the nature of these roots depends on context.

In scientific computations, data are real/complex numbers in general. The \(N\) roots of unity are usually taken to be the evenly-spaced points on the complex unit circle \(0 \le k < N:\: \zeta^k \coloneq \exp{(\frac{2 \pi i k}{N})}\).

In discrete computational problems, data are usually finite field/finite domain elements. The often repeated mantra is that the \(N\) roots of unity are generated by a \emph{primitive} \(N\textsuperscript{th}\) root of unity, an element \(\zeta\) in the field/domain such that \(\zeta^N = 1\), \(\forall 0 < k < N:\: \zeta^k \neq 1\).

In non-integral rings, for example \(\Z_{32}, \Z_{24}\), primitivity alone no longer suffices
\begin{example}
    \(x^2 - 1 = 0\) has 4 solutions over \(\Z_8\): \(x = 1, 3, 5, 7 \pmod{8}\), among which \(3, 5, 7\) are all primitive \(2\textsuperscript{nd}\) roots of unity. Are they suitable for a length-2 NTT? Let us look at the the fourier(Vandermonde) matrix of the root \(\zeta = 5\).
    \[\bm{V} = \begin{pmatrix}
        \zeta^{0} & \zeta^{0} \\
        \zeta^{0} & \zeta^{1}
    \end{pmatrix} = \begin{pmatrix}
        1 & 1 \\
        1 & 5
    \end{pmatrix} \qquad \det{(\bm{V})} = 5 - 1 = 4\]
    \(\bm{V}\) is not even inverible over \(\Z_8\). This is also true for other primitive roots of unity.
\end{example}

On close inspection, the non-invertibility of \(\bm{V}\) is the only obstruction. We conclude that in the context of non-integral rings, the \(N\textsuperscript{th}\) root of unity suitable for NTT/FFT application is one for which its corresponding fourier matrix \(\bm{V}\) is invertible.

\begin{definition}{(Principal root of unity, adapted from~\cite{MISC:WikiRoot})} \label{def:PrincipalRoot}
    Let \(\RingR\) be a commutative ring with identity. We call \(\zeta \in \RingR\) a principal \(N\textsuperscript{th}\) root of unity if
    \begin{enumerate}
        \item \(N\) is invertible (equivalently, \(N\) is coprime to the ring characterstic \(\mathsf{char}(\RingR)\))
        \item \(\zeta^N = 1\)
        \item \(\forall 1 \le k < N:\: \sum_{i=0}^{N-1}\zeta^{ik} = 0\)
    \end{enumerate}
\end{definition}

The following proposition is a direct consequence of \cref{def:PrincipalRoot}.
\begin{proposition} \label{prop:InvFourierMat}
    If \(\zeta\) is a principal \(N\textsuperscript{th}\) root of unity, then the fourier matrix \(\bm{V} \coloneq \bm{V}(1, \zeta, \ldots, \zeta^{N-1})\), \(\forall 0 \le i,j < N:\:\bm{V}_{i,j} = \zeta^{ij}\) is invertible with inverse \(\bm{V}^{-1} = \frac{1}{N}\bm{V}^{\ast}\), \(\bm{V}^{\ast}_{i,j} = \zeta^{-ij}\).
\end{proposition}

\ifFullVersion
Let \(p \ne 2\) be a prime. A well known result due to Gau{\ss} says for any \(m \ge 1\), the unit group \(\Z_{p^m}^{\times} \cong \Cyclic{\phi(p^m)} = \Cyclic{p^{m-1}(p-1)}\) is cyclic. In fact, all units in the (unique) order \((p-1)\) subgroup of \(\Z_{p^m}^{\times}\) are principal.
\begin{proposition} \label{prop:SubgrpPrincipal}
    Let \(\zeta \in \Z_{p^m}^{\times}\) generates the unique subgroup of order \((p - 1)\). Then \(\zeta\) is a principal \((p-1)\textsuperscript{th}\) root of unity.
\end{proposition}
\begin{proof}
    Let \(N = p - 1\). 1 and 2 in \cref{def:PrincipalRoot} is obvious. Note that for any \(1 \le k < N\), \((\zeta^k - 1)(1 + \zeta^k + \ldots + \zeta^{k(N-1)}) = \zeta^{Nk} - 1 = 0\). Since \(\zeta \bmod p\) is a primitive \((p-1)\textsuperscript{th}\) root of unity in \(\Z_p\), \(\zeta^k - 1 \ne 0 \pmod{p}\). Hence \(\zeta^k - 1\) is relatively prime to \(p^m\) and is invertible over \(\Z_{p^m}\). This proves 3 in \cref{def:PrincipalRoot}.
\end{proof}
\fi

Although \(\Z_{p^m}\) contains a principal \((p-1)\textsuperscript{th}\) root of unity, which is a generator of the unique cyclic subgroup of \(\Z_{p^m}^{\times}\) order \((p - 1)\), the problem is that in most cases of interest, the convolution length \(N \gg p\) (this holds in particular when \(p = 2\)). To find large principal roots of unity while still preserving the modular structure forces us to look at extension rings. This is where the Galois Ring comes into our picture.

Galois Rings can be motivated, defined and represented in a number of different ways. We refer the reader to \cite{BOOK:GilFla12,BOOK:Macdonald74} for more backgrounds and theories. Here we would like to think of a Galois Ring \(\GalRing{p^m}{r}\) as degree \(r\) extension of \(\Z_{p^m}\) in the same way that the Galois field \(\mathbb{F}_{p^r}\) is a degree \(r\) extension of \(\Z_p\).

\begin{definition}{(Galois Ring~\cite{MISC:WikiGalRing})} \label{def:GaloisRing}
    The Galois Ring \(\GalRing{p^m}{r}\) can be represented by a quotient polynomial ring \(\Z[x] / (p^m, f(x))\) where \(f(x)\) is a degree \(r\) monic polynomial which is also irreducible \(\bmod \  p\).
\end{definition}

Just like finite fields, all Galois Rings with the same modulus \(p^m\) and extension degree \(r\) are isomorphic. In some sense \(\GalRing{p^m}{r}\) doesn't depend on the particular choice of \(f(x)\). However, some \(f(x)\) are more convienient from a computational point of view.

In finite field theory, a degree \(r\) polynomial \(f(x) \in \Z_p[x]\) is called \emph{primitive} if \(f(x)\) is monic irreducible and \(x \pmod{p, f(x)}\) has order \(p^r - 1\) in \(\mathbb{F}_{p^r} \cong \Z_p[x]/(f(x))\). In other words, the equivalent class of \([x]\) is a primitive \((p^r - 1)\textsuperscript{th}\) root of unity.

We would like to find analogues of primitive polynomials over the ring \(\Z_{p^m}[x]\). Indeed, using Hensel's lifting technique, we can lift a primitive polynomial \(f(x) \in \Z_p[x]\) to \(F(x) \in \Z_{p^m}[x]\). We will show that the lifted polynomial has desirable properties.
\begin{theorem}{(Hensel Lifting, integral form~\cite{MISC:WikiHensel})} \label{thm:HenselLifting}
    Suppose \(f(x) \equiv \alpha_0 g(x) h(x) \pmod{p}\), where \(\alpha_0\) is not divisible by \(p\) and \(g(x), h(x)\) are monic polynomials that are coprime \(\bmod \  p\). Then \(\forall k \ge 1\) there exist polynomials \(g_k(x), h_k(x) \in \Z[x]\) unique up to \(\bmod \  p^k\) such that
    \begin{enumerate}
        \item \(g_k(x) \equiv g(x) \pmod{p} \qquad f_k(x) \equiv f(x) \pmod{p}\)
        \item \(f(x) \equiv \alpha_0 g_k(x) f_k(x) \pmod{p^k}\)
    \end{enumerate}
\end{theorem}
\begin{proposition} \label{prop:LiftedPrimPoly}
    Let \(f(x)\) be a primitive polynomial \(\bmod \  p\) of degree \(r\), there exists a monic polynomial \(g(x)\) unique up to \(\bmod \  p\) such that
    \[x^{p^r - 1} - 1 \equiv f(x) g(x) \pmod{p}\]

    Now apply \cref{thm:HenselLifting} Hensel lifting to the equation above. We can find a unique polynomial \(f_m(x) \in \Z_{p^m}[x]\) such that \(f_m(x) \equiv f(x) \pmod{p}\) and \(f_m(x) \mid x^{p^r - 1} - 1\) over \(\Z_{p^m}[x]\).

    Let the Galois Ring be defined over this polynomial \(\GalRing{p^m}{r} \cong \Z[x] / (p^m, f_m(x))\). We claim that:
    \begin{enumerate}
        \item The equivalent class \(x \pmod{p^m, f_m(x)}\) has order \(p^r - 1\) over \(\GalRing{p^m}{r}^{\times}\). Moreover,
        \item The equivalent class \(x \pmod{p^m, f_m(x)}\) is a principal \((p^r - 1)\textsuperscript{th}\) root of unity over \(\GalRing{p^m}{r}\). Hence
        \item For any \(N \mid p^r - 1\), the equivalent class \(x^{\frac{p^r - 1}{N}} \pmod{p^m, f_m(x)}\) is a principal \(N\textsuperscript{th}\) root of unity.
    \end{enumerate}
\end{proposition}
\begin{proof}
    \noindent1. \quad Since \(f_m(x) \mid x^{p^r -  1} - 1\) over \(\Z_{p^m}[x]\), \(x^{p^r - 1} \equiv 1 \pmod{p^m, f_m(x)}\). Suppose there exists a \(0 < k < p^r - 1\) such that \(x^k \equiv 1 \pmod{p^m, f_m(x)}\). Since \(f_m(x) \equiv f(x) \pmod{p}\), we can reduce \(\bmod \  p\) and obtain \(x^k \equiv 1 \pmod{p, f(x)}\), contradiction to the fact that \(f(x)\) is a primitive polynomial \(\bmod \  p\).

    \smallskip
    \noindent2. \quad The only nontrivial part to verify is condition 3 in \cref{def:PrincipalRoot}. Let \(N = p^r - 1\) and fix \(0 < k < N\). It is easy to see that \((x^k - 1)(\sum_{i=0}^{N-1} x^{ik}) = x^{kN} - 1 \equiv 0 \pmod{p^m, f_m(x)}\). We claim that \(x^k - 1 \pmod{p^m, f_m(x)}\) has a multiplicative inverse over \(\Z_{p^m}[x]\). If the claim is true, we can multiply the inverse and obtain \(\sum x^{ik} \equiv 0 \pmod{p^m, f_m(x)}\). The equivalent class \([x]\) is therefore a principal \((p^r - 1)\textsuperscript{th}\) root of unity.

    \ifFullVersion
    \medskip
    \noindent{\bf Claim:} \(\exists h(x):\: (x^k - 1)h(x) \equiv 1 \pmod{p^m, f_m(x)}\)

    \noindent\emph{proof of Claim.} \quad Since \(0 < k < N\), \(x^k - 1 \pmod{p, f(x)}\) is nonzero and has a multiplicative inverse \(h_1(x)\), i.e., \((x^k - 1)h_1(x) \equiv 1 \pmod{p, f_m(x)}\) (recall that \(\Z[x]/(p, f(x)) = \Z[x]/(p, f_m(x))\) is a field). We are going to lift the inverse \(\bmod \  p\) to one \(\bmod \  p^m\). To do so it is most convenient to employ a technique known as Newton-Raphson division~\cite{MISC:WikiNewton}

    \smallskip
    \noindent{\bf Newton-Rhaphson division: }Let \(l > 0\). Suppose \(\exists h_l(x)\) s.t. \((x^k - 1)h_l(x) \equiv 1 \pmod{p^l, f_m(x)}\). Define
    \[h_{l+1}(x) = 2 h_l(x) - (x^k - 1)h_l(x)^2\]
    Then \((x^k - 1)h_{l+1}(x) \equiv 1 \pmod{p^{l+1}, f_m(x)}\)

    \noindent\emph{proof of lifting.} \quad Write \((x^k - 1)h_l(x) = 1 = p^l M_l(x) + f_m(x) N_l(x)\) for some polynomials \(M_l(x), N_l(x)\). Then
    \begin{align*}
        &(x^k - 1)^2h_l(x)^2 = 1 + 2p^l M_l(x) + p^{l+1}(p^{l-1}M_l(x)^2) + f_m(x)\left(f_m(x) N_l(x)^2  \right.\\
        &\left. + 2 N_l(x) (1 + p^l M_l(x)) \right) \\
        &2(x^k - 1)h_l(x) = 2 + 2p^l M_l(x) + f_m(x) N_l(x) \\
        \implies &(x^k - 1)h_{l+1}(x) = 1 + p^{l+1} M_{l+1}(x) + f_m(x) N_{l+1}(x)
    \end{align*}
    for some polynomials \(M_{l+1}(x), N_{l+1}(x)\). Therefore we can use Newton-Rhaphson division to lift the inverse up to \(\bmod \  p^m\). This shows that \(x^k - 1\) and the claim is proven.

    \medskip
    \else
    We refer reader to \cref{proof:LiftedPrimPoly} in the appendix for a detailed proof of the claim.
    \fi
    \noindent3. \quad is a straightforward consequence of 2.
\end{proof}

\subsection{On Efficient Lifting}
We need o address an uncomfortable algorithmic issue before we proceed to the next section. Traditionally, Hensel Lifting is usually accomplished by starting with a coprime factoization \(f(x) = g(x)h(x) \pmod{p}\) and use inexpensive polynomial GCD operations to lift to the factorization \(f(x) = f_m(x) g_m(x) \pmod{p^m}\). Our trouble is that both \(x^{p^r - 1} - 1\) and \(x^{p^r - 1} - 1 / f(x)\) are too big even for moderately large \(r\) \ifFullVersion(We tried to key in \(x^{2^{32} - 1} - 1\) into the Sagemath/Python but the system complains and refuses to digest it) \fi.

Fortunately, there is a way to only lift the primitive polynomial \(f(x)\) without knowing or caring about its coprime factor. The method we use comes from \cite{IRISHMATH:Gary01}, but it may already be described and used in other contexts.

\begin{proposition}{(Adapted from \cite{IRISHMATH:Gary01} Theorem 1)} \label{prop:LiftPrimOnly}
    Let \(k > 0\) and suppose a monic polynomial \(f_k(x) \in \Z[x]\) satisfies:
    \begin{itemize}
        \item \(f_k(x) \bmod p^k\) is irreducible over \(\Z_{p^k}[x]\)
        \item \(\exists M\) coprime to \(p\) such that \(f_k(x) \mid x^M - 1\) over \(\Z_{p^k}[x]\)
    \end{itemize}
    We let \(f_{k+1}(x)\) be a monic polynomial whose roots are the \(p\textsuperscript{th}\) power of the roots of \(f_k(x)\) over an algebraically closed field. \(f_{k+1}\) satisfies the following properties:
    \begin{enumerate}
        \item \(f_{k+1}(x) \in \Z[x]\) is integral
        \item \(f_{k+1}(x) \equiv f_k(x) \pmod{p^k}\), hence \(f_{k+1}(x)\) is irreducible over \(\Z_{p^{k+1}}[x]\)
        \item \(f_{k+1}(x) \mid x^M - 1\) over \(\Z_{p^{k+1}}[x]\)
    \end{enumerate}
    In otherwords, the Hensel Lifting of \(f_k(x) \bmod p^k\) is exactly \(f_{k+1}(x) \bmod p^{k+1}\)
\end{proposition}

\ifFullVersion
\begin{proof}
    For the proof we are going to use some p-adic theory. Let \(\mathcal{Z}_p\) be the ring of p-adic integers and \(\mathcal{Q}_p\) the field of p-adic rationals. Since \(M\) is coprime to \(p\) the polynomial \(x^M - 1\) has \(M\) distinct roots of unity over an extension field of \(\mathcal{Q}_p\).

    By Hensel Lifting Lemma~\cref{thm:HenselLifting}, there exists \(f_{k+1}(x), g(x) \in \Z[x]\) such that \(f_{k+1}(x) \mid x^M - 1\) over \(\Z_{p^{k+1}}[x]\) and \(f_{k+1}(x) \equiv f_k(x) + p^k g(x) \pmod{p^{k+1}}\). Therefore item 1 and 2 of \cref{prop:LiftPrimOnly} are immediate, and it remains to show item 3.

    Moreover, if \(\alpha_k\) is a root of \(f_k(x)\) over \(\Z_{p^k}\), namely \(f_k(\alpha_k) \equiv 0 \pmod{p^k}\). There would exist a root \(\alpha_{k+1} = \alpha_k + p^k \delta\), where \(\delta\) lies in an extension field of \(\mathcal{Q}_p\), of \(f_{k+1}(x)\) over \(\Z_{p^{k+1}}\). In other words, \(f_{k+1}(\alpha_{k+1}) \equiv 0 \pmod{p^{k+1}}\).

    Since \(f_k(x) \mid x^M - 1\) over \(\Z_{p^k}[x]\), there exists an \(\epsilon\) in an extension field of \(\mathcal{Q}_p\) such that \(\alpha_k^M = 1 + p^k \epsilon\). Because
    \begin{align*}
        &\alpha_{k+1}^p = (\alpha_k + p^k \delta)^p = \alpha_k^p + O(p^{k+1}) \equiv \alpha_k^p \pmod{p^{k+1}} \\
        &\alpha_{k+1}^{pM} = (\alpha_k + p^k \delta)^{pM} = \alpha_k^{pM} + O(p^{k+1}) = (1 + p^k \epsilon)^p + O(p^{k+1}) = 1 + O(p^{k+1}) \equiv 1 \pmod{p^{k+1}}
    \end{align*}
    Hence the \(p\textsuperscript{th}\) power of distinct roots \(\alpha_k\) of \(f_k(x)\) over \(\Z_{p^k}\) are all distinct roots of \(x^M - 1\) over \(\Z_{p^{k+1}}\). In addition, \(\alpha_{k+1}^p \equiv \alpha_k^p \equiv \alpha_k \pmod{p}\), and we must therefore have \(f_k(\alpha_k^p) \equiv 0 \pmod{p^k}\).

    The roots of \(f_{k+1}\) over \(\Z_{p^{k+1}}\) are, up to \(\bmod \  p^{k+1}\) the \(p\textsuperscript{th}\) power of all the roots of \(f_k(x)\) over \(\Z_{p^k}\). Therefore item 3 is proven.
\end{proof}
\else
\begin{proof}
    The basic idea is to consider an extension field of the p-adic rationals \(\mathcal{Q}_p\) and use some p-adic calculation to verify that all properties above hold. We refer the reader to \cref{proof:LiftPrimOnly} in the appendix for a detailed proof of \cref{prop:LiftPrimOnly}.
\end{proof}
\fi

Similar to GCD operations, we can in fact calculate the lifting using operations over the ground ring \(\Z\). This can be done with polynomial resultants.
\begin{definition}{(Univariate Resultant \cite{MISC:WikiResultant})} \label{def:Resultant}
    Let \(f(x) = a_0 + a_1 x + \ldots + a_n x^n\), \(g(x) = b_0 + b_1 x + \ldots + b_m x^m\) where \(a_n, b_m \neq 0\). The resultant of \(f, g\) is the determinant of the \((m+n)\times(m+n)\) Sylvester matrix:
    \[\mathsf{Res}(f, g) \coloneq \det
        \begin{pmatrix}
            a_0 & a_1 & \cdots & a_n & 0 & \cdots & 0 \\
            0 & a_0 & a_1 & \cdots & a_n & \cdots & 0 \\
            \vdots & \ddots & \ddots & \ddots & \ddots & \ddots & \vdots \\
            0 & \cdots & 0 & a_0 & a_1 & \cdots & a_n \\
            b_0 & b_1 & \cdots & b_m & 0 & \cdots & 0 \\
            0 & b_0 & b_1 & \cdots & b_m & \cdots & 0 \\
            \vdots & \ddots & \ddots & \ddots & \ddots & \ddots & \vdots \\
            0 & \cdots & 0 & b_0 & b_1 & \cdots & b_m \\
            \end{pmatrix}
    \]
    In particular, if \((\alpha_i)_{i=1}^n,\, (\beta_j)_{j=1}^m\) are the roots of \(f, g\) in some extension field. Then
    \[\mathsf{Res}(f,g) = a_0^m \prod_{i=1}^{n}g(\alpha_i) = (-1)^{mn}b_0^n \prod_{j=1}^{m} f(\beta_j)\]
\end{definition}

\begin{proposition} \label{prop:PowerP}
    Let \(d > 0\), \(f(x) \in \Z[x]\) be a degree \(n\) monic polynomial, \(g(x) = \mathsf{Res}_y(x - y^d, f(y))\) the resultant of \(x - y^d, f(y)\) considered as polynomials in \(y\) with coefficients in \(\Z[x]\). Then \(g(x) \in \Z[x]\) with leading coefficient \(\pm 1\). Moreover, the roots of \(g(x)\) are exactly the \(d\textsuperscript{th}\) power of all the roots of \(f(x)\) over an algebraically closed field.
\end{proposition}
\begin{proof}
    Let \(\mathcal{K}\) be an algebraically closed field containing \(\mathbb{Q}(x)\). Let \(\beta_0, \ldots, \beta_{n-1} \in \mathcal{K}\) be the roots of \(f(y)\) and \(\zeta \in \mathcal{K}\) a primitive \(d\textsuperscript{th}\) root of unity. We have
    \[ x - y^d = \prod_{i=0}^{d-1} (x^{\frac{1}{d}} - \zeta^i y), \qquad 
    f(y) = \prod_{i=0}^{n-1} (y - \beta_i) \]
    Therefore the product over root property in \cref{def:Resultant} asserts that
    \begin{align*}
        &\mathsf{Res}_y(x-y^d, f(y)) = (-1)^n \prod_{i=0}^{d-1} f(\zeta^{d-i} x^{\frac{1}{d}}) = (-1)^n \prod_{i=0}^{d-1} \prod_{j=0}^{n-1}(\zeta^{d-i} x^{\frac{1}{d}} - \beta_j) \\
        &= (-1)^n \prod_{j=0}^{n-1}\left(\prod_{i=0}^{d-1}\zeta^{d-i}\right)\prod_{i=0}^{d-1}(x^{\frac{1}{d}} - \zeta^i \beta_j) = (-1)^n \zeta^{\frac{d(d-1)n}{2}} \prod_{j=0}^{n-1} (x - \beta_j^d) \\
        &= \pm \prod_{j=0}^{n-1}(x - \beta_j^d)
    \end{align*}
    Therefore, up to sign, \(g(x)\) is the monic polynomial whose roots are exactly the \(d\textsuperscript{th}\) power of the roots of \(f(x)\). \(g(x) \in \Z[x]\) since the coefficients of \(x - y^n, f(y)\) all belong to \(\Z[x]\)
\end{proof}

\begin{remark}
    The Sagemath library contains a method called adams\_operator\_on\_roots. When given a polynomial and an exponent \(d\), this method produces another polynomial whose roots are the \(d\textsuperscript{th}\) powers of roots of the given polynomial. The source code implementation turns out to be exactly the Resultant computation as in \cref{prop:PowerP}.
\end{remark}

We can combine \cref{prop:LiftPrimOnly,prop:PowerP} to construct an efficient algorithm to lift primitive polynomials.

\begin{algorithm}[h]
\caption{Hensel Lift Primitive Polynomial}\label{alg:HenselLift}
\begin{algorithmic}[1]
    \Require Monic degree \(r\) primitive polynomial \(f(x) \in \Z_p[x]\) and exponent \(m\)
    \Ensure The Hensel Lifted monic polynomial \(f_m(x) \in \Z_{p^m}[x]\)
    \State Let \(f_1(x) = f(x)\) and regard \(f_1(x) \in \Z[x]\)
    \For{\(k \gets 2\) to \(m\)}
        \State Calculate \(g(x) = \mathsf{Res}_y(x - y^p, f_{k-1}(y))\) and normalize \(g(x)\) to be monic
        \State Let \(f_k(x) = g(x) \bmod p^k\)
    \EndFor
    \State {\bf Return} \(f_m(x)\)
\end{algorithmic}
\end{algorithm}
\ifFullVersion
\begin{remark}
    Alternatively, we may simply calculate \(g(x) = \mathsf{Res}_y(x - y^{p^m}, f(y))\) and directly obtain \(f_m(x) = g(x) \bmod p^m\). The difference is mainly that of efficiency.

    In \cref{alg:HenselLift} we calculate \(m-1\) determinants whose matrices are of dimension \(p + r - 1\) whereas here we calculate 1 determinant whose matrix is of dimension \(p^m + r - 1\)
\end{remark}
\begin{remark}
    When \(p = 2\), we may use the following simplified procedure inside the for loop of \cref{alg:HenselLift}:
    \begin{itemize}
        \item 3(b). Calculate \(G(x) = f_{k-1}(x) f_{k-1}(-x)\). Replace \(x^2\) by \(x\) to obtain \(g(x) = G(\sqrt{x})\). Normalize \(g(x)\) to be monic.
        \item 4(b). Let \(f_k(x) = g(x) \bmod 2^k\)
    \end{itemize}
\end{remark}
\begin{example}
    Let \(p = 2\), \(f(x) = x^5 + x^2 + 1\) is a monic primitive polynomial over \(\Z_2[x]\). According to \cref{alg:HenselLift} and the previous remark
    \begin{align*}
        f_1(x)f_1(-x) &= -x^{10} + x^4 + 2x^2 + 1 \\
        f_2(x) &= x^5 + 3x^2 + 2x + 3 \\
        f_2(x)f_2(-x) &= -x^{10} - 4x^6 + 9x^4 + 14x^2 + 9 \\
        f_3(x) &= x^5 + 4x^3 + 7x^2 + 2x + 7 \\
        f_3(x)f_3(-x) &= -x^{10} - 8x^8 - 20x^6 + 33x^4 + 94x^2 + 49 \\
        f_4(x) &= x^5 + 8x^4 + 4x^3 + 15x^2 + 2x + 15
    \end{align*}
    We can verify that the class \([x]\) is a principal \(2^5 - 1 = 31\textsuperscript{th}\) root of unity in the Galois Ring \(\GalRing{2^4}{5} \cong \Z[x]/(16, f_4(x))\)
\end{example}
\fi
\begin{example}
    Let \(p = 3\), \(f(x) = x^5 + 2x + 1\) is a monic primitive polynomial over \(\Z_3[x]\). According to \cref{alg:HenselLift}
    \begin{align*}
        \mathsf{Res}_y(x - y^3, f(y)) &= -x^5 + 6x^2 - 8x - 1 \\
        f_2(x) &= x^5 + 3x^2 + 8x + 1 \\
        \mathsf{Res}_y(x - y^3, f_2(y)) &= -x^5 - 9x^4 - 27x^3 - 3x^2 - 440x - 1 \\
        f_3(x) &= x^5 + 9x^4 + 3x^2 + 8x + 1 \\
        \mathsf{Res}_y(x - y^3, f_2(y)) &= -x^5 - 738x^4 - 1944x^3 - 1650x^2 - 440x - 1 \\
        f_4(x) &= x^5 + 9x^4 + 30x^2 + 35x + 1
    \end{align*}
    We can easily verify that the equivalent class \([x]\) is a principal \(3^5 - 1 = 242\textsuperscript{th}\) root of unity in the Galois Ring \(\GalRing{3^4}{5} \cong \Z[x]/(81, f_4(x))\)
\end{example}